# 手写板 开发文档

by 陈晔 kylechenszu@foxmail.com



## 功能详解

### 概述

本手写板demo主要为实现电子签名而开发，主要基于 vue2.0，使用 vuecli 进行搭建管理。绘画功能基于canvas实现。样式采用ant design vue(简易使用)。额外使用了第三方颜色拾取器 [vcolorpicker](https://github.com/zuley/vue-color-picker)

![概览 ](C:\Users\Administrator\Desktop\手写板gif\1.gif)

### 保存

把当前的画布保存为两个格式的图片文件分别为jpg格式和png格式

通过canvas自带api生成对应格式文件，然后嵌入a标签元素中下载



### 清除

清除当前画布的内容并重新绘制画布背景（纯白）

清除功能不清除画布的记录的轨迹



### 重绘

在画布清除后通过之前记录的轨迹数组对画布进行重新绘制复现之前的图像轨迹

依赖于轨迹数组，如果数组被清空则无法重绘，

重绘功能可用时按钮会高亮显示



### 清除重绘

清空轨迹数组，清空后无法使用重绘和导出重绘的功能

清除功能可用时按钮高亮显示



### 导出重绘

导出轨迹数组并保存为JSON文件

通过嵌入a标签元素中进行下载

功能可用时按钮高亮显示



### 导入重绘

导入之前导入的JSON文件并转换为轨迹，并显示导入的文件名



### 导入图片

导入图片并绘制在canvas上，并显示导入的文件名

导入图片会清空画布



### 撤回

撤回只上一笔书写的状态

依赖于轨迹数组，通过遍历删除最后一段轨迹进行重绘而实现



### 橡皮差

对比于撤回的按逆序撤回，橡皮差实现乱序分段的的轨迹擦除

通过记录橡皮差起始点的轨迹，以两点为单位遍历轨迹数组，进行线段相交检测，如相交则擦除该线段

线段相交检测采取快速排斥+跨立检测



## 属性以及函数



## 已知问题

### 1.导入轨迹

通常来说这种事情不会发生，因为导入都是保存的轨迹数组。但是在测试中如果导入大文件可能会导致卡死

改进方法：加入文件大小检测，限制提交文件大小



### 2.导入图片

当导入图片的大小过大会出现和导入轨迹相同的问题，当导入的图片尺寸过大在画布上可能会显示不全

改进方法：限制提交图片大小，尺寸