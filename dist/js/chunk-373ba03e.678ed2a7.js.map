{"version":3,"sources":["webpack:///./src/views/elementUI.vue?3a34","webpack:///./src/views/Signature/SignatureCore.vue?b11f","webpack:///src/views/Signature/SignatureCore.vue","webpack:///./src/views/Signature/SignatureCore.vue?b622","webpack:///./src/views/Signature/SignatureCore.vue?6948","webpack:///src/views/elementUI.vue","webpack:///./src/views/elementUI.vue?ede6","webpack:///./src/views/elementUI.vue?9768","webpack:///./src/views/elementUI.vue?d2b8","webpack:///./src/views/Signature/SignatureCore.vue?e7ea","webpack:///./src/views/Signature/SignatureCore.vue?416b"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","download","_v","model","value","callback","$$v","imageType","expression","_l","item","key","vlaue","label","clear","btnHighlight","imgFlag","repaint","clearTrace","saveTraceAsJSON","fileInput","imageInput","traceBackWard","eraserFlag","eraserTrigger","penShape","penSizeChange","width","colorChange","color","ref","Number","updateBtnHight","updateImgFlag","updateEraserFlag","uploadImageToFather","uploadTraceJSONToFather","staticRenderFns","_m","staticStyle","props","lineWidth","type","default","lineColor","String","canvasBgColor","data","openKeys2","openKeys","canvas","cxt","trace","flag","file","fileInputBtn","imageInputBtn","image","imageToInsert","newTrace","eraserTrace","minusX","minusY","watch","length","$emit","methods","showMenu","openChange","injectImage","drawImageOnCanvas","injectJSON","JSON","parse","json","concat","mobileCompute","getBoundingClientRect","x","y","isMobile","penShapeCompute","index","len","j","end","push","decay","branchFlag","i","beginAndMove","draw","shift","clearCanvas","image2Canvas","eraserTheLine","x1","y1","x2","y2","x3","y3","x4","y4","res","judgeIntersect","removeThisLine","u","v","w","z","conditon1","Math","min","max","condition2","condition3","condition4","start","splice","rePaint","img","Image","src","onload","drawImage","penFlag","rePaintTrace","click","backFlag","slice","alert","content","stringify","jsonLink","document","createElement","blob","Blob","href","URL","createObjectURL","eraserTraceInput","traceInput","strokeStyle","shadowColor","isNaN","imgTypeChange","getDOMEl","querySelector","canvasSupTest","getContext","section","className","innerHTML","prepend","Error","porpertyInit","clientWidth","height","clientHeight","fillStyle","fillRect","lineCap","lineJoin","shadowBlur","beginPath","moveTo","lineTo","stroke","close","toDataURL","downLoadLink","clearRect","windowToCanvas","console","log","window","innerWidth","innerHeight","components","mounted","addEventListener","body","e","component","options","$refs","sigCore","newValue","traceJSON"],"mappings":"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","file":"js/chunk-373ba03e.678ed2a7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('el-menu',{staticClass:\"el-menu-demo\",attrs:{\"mode\":\"horizontal\"}},[_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"1\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.download()}}},[_vm._v(\"保存\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"2\"}},[_vm._v(\" 格式： \"),_c('el-select',{staticClass:\"selectModule\",attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.imageType),callback:function ($$v) {_vm.imageType=$$v},expression:\"imageType\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.vlaue,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"3\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.clear()}}},[_vm._v(\"清除\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"4\"}},[_c('el-button',{attrs:{\"type\":_vm.btnHighlight || _vm.imgFlag ? 'primary' : ''},on:{\"click\":function($event){return _vm.repaint()}}},[_vm._v(\"重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"5\"}},[_c('el-button',{attrs:{\"type\":_vm.btnHighlight || _vm.imgFlag ? 'primary' : ''},on:{\"click\":function($event){return _vm.clearTrace()}}},[_vm._v(\"清除重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"6\"}},[_c('el-button',{attrs:{\"type\":_vm.btnHighlight || _vm.imgFlag ? 'primary' : ''},on:{\"click\":function($event){return _vm.saveTraceAsJSON()}}},[_vm._v(\"导出重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.fileInput()}}},[_vm._v(\"导入重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"},on:{\"click\":function($event){return _vm.imageInput()}}},[_c('el-button',[_vm._v(\"导入图片\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.traceBackWard()}}},[_vm._v(\"撤回\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('el-button',{attrs:{\"type\":_vm.eraserFlag ? 'primary' : ''},on:{\"click\":function($event){return _vm.eraserTrigger()}}},[_vm._v(\"橡皮擦\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.penShape()}}},[_vm._v(\"笔锋\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('span',[_vm._v(\"粗细：\")]),_c('el-input',{staticClass:\"width-input\",attrs:{\"placeholder\":\"输入粗细\",\"clearable\":\"\"},on:{\"blur\":function($event){return _vm.penSizeChange(_vm.width)}},model:{value:(_vm.width),callback:function ($$v) {_vm.width=$$v},expression:\"width\"}})],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('span',[_vm._v(\"颜色：\")]),_c('el-color-picker',{on:{\"change\":function($event){return _vm.colorChange(_vm.color)}},model:{value:(_vm.color),callback:function ($$v) {_vm.color=$$v},expression:\"color\"}})],1)],1),_c('signatureCore',{ref:\"sigCore\",attrs:{\"imageType\":_vm.imageType,\"lineWidth\":Number(_vm.width),\"lineColor\":_vm.color},on:{\"updateBtnHight\":_vm.updateBtnHight,\"updateImgFlag\":_vm.updateImgFlag,\"updateEraserFlag\":_vm.updateEraserFlag,\"uploadImageToFather\":_vm.uploadImageToFather,\"uploadTraceToFather\":_vm.uploadTraceJSONToFather}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"canvas_container\"},[_c('canvas',{attrs:{\"id\":\"canvas\"}}),_c('input',{attrs:{\"id\":\"fileInputBtn\",\"type\":\"file\",\"multiple\":\"\"}}),_c('input',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"imageInputBtn\",\"type\":\"file\",\"multiple\":\"\"}})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"canvas_container\">\r\n    <canvas id=\"canvas\"></canvas>\r\n    <input id=\"fileInputBtn\" type=\"file\" multiple />\r\n    <input style=\"display:none;\" id=\"imageInputBtn\" type=\"file\" multiple />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  // 暴露的参数\r\n  props: {\r\n    lineWidth: {\r\n      // 线条宽度 默认为5\r\n      type: Number,\r\n      default: 5\r\n    },\r\n    lineColor: {\r\n      // 线条颜色 默认黑色\r\n      type: String,\r\n      default: '#000'\r\n    },\r\n    canvasBgColor: {\r\n      // 绘画框背景颜色\r\n      type: String,\r\n      default: '#fff'\r\n    },\r\n    imageType: {\r\n      // 默认的图片类型\r\n      type: String,\r\n      default: 'jpg'\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      openKeys2: [],\r\n      openKeys: [],\r\n      canvas: '', // canvas画布\r\n      // lineWidth: '', // 线条宽度 默认为5\r\n      // lineColor: '', // 线条颜色\r\n      // canvasBgColor: '', // 绘画框背景颜色\r\n      // imageType: 'jpg', // 将要保存的图片类型 默认jpg\r\n      cxt: '', // canvas的context,\r\n      trace: [], // 轨迹变量数据\r\n      flag: '', // 鼠标移动时的标志量\r\n      btnHighlight: false, // 按钮高亮标志量\r\n      imgFlag: false, // 图片功能关联的重绘和消除重绘高亮\r\n      file: '', // 传入的文件\r\n      fileInputBtn: '', // 文件选择输入按钮\r\n      imageInputBtn: '', // 图片选择输入按扭\r\n      image: '', // 导入的图片\r\n      imageToInsert: '', // 要导入canvas的图片\r\n      newTrace: '', // 导入的新轨迹\r\n      // ImageData: ''\r\n      eraserFlag: false, // 橡皮擦功能启动标志位\r\n      eraserTrace: [], // 橡皮擦轨迹\r\n      minusX: '', // 移动端画布x轴偏移值\r\n      minusY: '', // 移动端画布y轴偏移值\r\n      color: this.lineColor,\r\n      width: this.lineWidth\r\n    }\r\n  },\r\n  watch: {\r\n    trace () {\r\n      // 只能使用watcher 如果在按钮属性直接使用三元表达式会导致书写卡顿\r\n      if (this.trace.length > 0) {\r\n        this.btnHighlight = true\r\n      } else {\r\n        this.btnHighlight = false\r\n      }\r\n      this.$emit('updateBtnHight', this.btnHighlight) // 同时向外部更新\r\n    },\r\n    imageToInsert () {\r\n      if (this.imageToInsert) {\r\n        this.imgFlag = true\r\n      } else {\r\n        this.imgFlag = false\r\n      }\r\n      this.$emit('updateImgFlag', this.imgFlag) // 同时向外部更新\r\n    }\r\n  },\r\n  methods: {\r\n    // dataTest () {\r\n    //   this.ImageData = this.cxt.getImageData(\r\n    //     0,\r\n    //     0,\r\n    //     this.canvas.width,\r\n    //     this.canvas.height\r\n    //   )\r\n    //   console.log(ImageData)\r\n    // },\r\n    // dataTest2 () {\r\n    //   this.cxt.putImageData(this.ImageData, 0, 0)\r\n    // },\r\n    showMenu () {\r\n      this.openKeys = this.openKeys2\r\n    },\r\n    openChange () {\r\n      this.openKeys2 = this.openKeys\r\n      // console.log(this.openKeys)\r\n    },\r\n    /* 外部图片传入 */\r\n    injectImage (image) {\r\n      // console.log(image)\r\n      this.imageToInsert = image\r\n      this.drawImageOnCanvas()\r\n    },\r\n    /* 外部JSON传入 */\r\n    injectJSON (json) {\r\n      // console.log(json)\r\n      this.newTrace = JSON.parse(json)\r\n      this.trace = this.trace.concat(this.newTrace)\r\n    },\r\n    /* 计算移动端偏移值 */\r\n    mobileCompute (flag = false) {\r\n      this.minusX = this.canvas.getBoundingClientRect().x\r\n      this.minusY = this.canvas.getBoundingClientRect().y\r\n    },\r\n    /* 判断浏览器是pc端还是移动端 */\r\n    isMobile () {\r\n      if (\r\n        window.navigator.userAgent.match(\r\n          /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i\r\n        )\r\n      ) {\r\n        return true // 移动端\r\n      } else {\r\n        return false // PC端\r\n      }\r\n    },\r\n    /* 笔锋测试 核心思路为线的宽度逐渐减少 */\r\n    penShapeCompute () {\r\n      var index = [] // 每条线段的终点坐标\r\n      var len = []\r\n      for (var j = 0; j < this.trace.length; j++) {\r\n        if (this.trace[j].end) {\r\n          index.push(j)\r\n        }\r\n      }\r\n      // console.log(index)\r\n      // 计算每段线段的长度\r\n\r\n      len[0] = index[0] + 1\r\n      for (let j = 1; j < index.length; j++) {\r\n        len.push(index[j] - index[j - 1])\r\n      }\r\n\r\n      // console.log(len)\r\n      // var count = 0\r\n      var decay = (this.lineWidth - 1) / len[0] // 宽度衰减值\r\n      // console.log(decay)\r\n      var branchFlag = true\r\n      // 遍历轨迹对象\r\n      for (var i = 0; i < this.trace.length; i++) {\r\n        // console.log(this.trace[i])\r\n        if (branchFlag) {\r\n          this.beginAndMove(this.trace[i].x, this.trace[i].y)\r\n          branchFlag = false\r\n          continue\r\n        }\r\n\r\n        // 逐渐改变线的宽度\r\n        this.cxt.lineWidth -= decay\r\n        // console.log(this.cxt.lineWidth)\r\n        this.draw(this.trace[i].x, this.trace[i].y)\r\n        if (this.trace[i].end) {\r\n          branchFlag = true\r\n          this.cxt.lineWidth = this.lineWidth\r\n          len.shift()\r\n          decay = (this.lineWidth - 1) / len[0]\r\n          // count += 1\r\n          // console.log(decay)\r\n        }\r\n      }\r\n      // console.log(count)\r\n    },\r\n    penShape () {\r\n      this.clearCanvas()\r\n      this.penShapeCompute()\r\n      this.image2Canvas(true)\r\n    },\r\n    /* 遍历轨迹数组 并根据检测结果擦除 */\r\n    eraserTheLine () {\r\n      for (var i = 0; i < this.trace.length - 1; i++) {\r\n        // 第一个点不能是终点 以防错误连线检测\r\n        if (!this.trace[i].end) {\r\n          // 相交检测\r\n          var x1 = this.eraserTrace[0].x\r\n          var y1 = this.eraserTrace[0].y\r\n          var x2 = this.eraserTrace[1].x\r\n          var y2 = this.eraserTrace[1].y\r\n          var x3 = this.trace[i].x\r\n          var y3 = this.trace[i].y\r\n          var x4 = this.trace[i + 1].x\r\n          var y4 = this.trace[i + 1].y\r\n          var res = this.judgeIntersect(x1, y1, x2, y2, x3, y3, x4, y4)\r\n          if (res) {\r\n            this.removeThisLine(i)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    /* 四点两两连线线段相交检测 注意传入参数的顺序 */\r\n    judgeIntersect (x1, y1, x2, y2, x3, y3, x4, y4) {\r\n      // 快速排斥\r\n      // 两个线段为对角线组成的矩形，如果两个矩形没有重叠的部分，那么两条线段一定不相交（但是重叠的矩形也有可能不相交）\r\n\r\n      // 1. 线段ab的低点低于cd的最高点（可能重合）\r\n      var conditon1 = Math.min(y1, y2) <= Math.max(y3, y4)\r\n      // 2. cd最左端小于ab最右端\r\n      var condition2 = Math.min(x3, x4) < Math.max(x1, x2)\r\n      // 3. cd的最低点低于ab的最高点（加上条件1，两线段在竖直方向上重合）\r\n      var condition3 = Math.min(y3, y4) < Math.max(y1, y2)\r\n      // 4. ab的最左端小于cd的最右端\r\n      var condition4 = Math.min(x1, x2) < Math.max(x3, x4)\r\n\r\n      // 综合以上4个条件 矩形是重合的（也包括矩形包含的情况） 这一步是判断那些绝对不重合的矩阵 即绝对不相交\r\n      if (!(conditon1 && condition2 && condition3 && condition4)) {\r\n        return false\r\n      }\r\n\r\n      // 剩下的用跨立实验判断\r\n      // 如果两条线段相交 必然跨立，以一条线段为标准，另一条线段的两端点一定在这条线段的两端\r\n      // 即ab两点在线段cd的两端 cd两点在线段ab的两端\r\n      // (ACxAB)*(ABxAD) <= 0\r\n      // AC AB 叉乘<=0\r\n      // AB AD 叉乘<=0\r\n      var u, v, w, z\r\n\r\n      // AC AB 叉乘 详见向量公式以及叉乘公式\r\n      u = (x3 - x1) * (y2 - y1) - (x2 - x1) * (y3 - y1)\r\n      // AD AB 叉乘\r\n      v = (x4 - x1) * (y2 - y1) - (x2 - x1) * (y4 - y1)\r\n      // 以下同理 即对于另一条线段也要判断是否在两侧\r\n      w = (x1 - x3) * (y4 - y3) - (x4 - x3) * (y1 - y3)\r\n      z = (x2 - x3) * (y4 - y3) - (x4 - x3) * (y2 - y3)\r\n      return u * v <= 0.00000001 && w * z <= 0.00000001\r\n    },\r\n    /* 传入坐标 移除该坐标所在的线段 */\r\n    removeThisLine (index) {\r\n      var start = 0\r\n      var end = 0\r\n      for (let i = index; i >= 0; i--) {\r\n        if (this.trace[i].end) {\r\n          start = i + 1\r\n          break\r\n        }\r\n      }\r\n      for (let i = index; i < this.trace.length; i++) {\r\n        if (this.trace[i].end) {\r\n          end = i\r\n          break\r\n        }\r\n      }\r\n      this.trace.splice(start, end - start + 1)\r\n      // console.log(this.trace)\r\n      this.rePaint()\r\n    },\r\n    eraserTrigger () {\r\n      this.eraserFlag = !this.eraserFlag\r\n      this.$emit('updateEraserFlag', this.eraserFlag)\r\n      this.eraserTrace = [] // 清空上一次的橡皮擦轨迹数组\r\n    },\r\n    image2Canvas (penFlag) {\r\n      var img = new Image()\r\n      // console.log(this.imageToInsert)\r\n      img.src = this.imageToInsert\r\n      // 异步事件的使用要特别注意\r\n      img.onload = function () {\r\n        this.cxt.drawImage(img, 0, 0)\r\n        // 重画之前的轨迹\r\n        if (this.trace.length > 0 && penFlag) {\r\n          this.penShapeCompute()\r\n        } else {\r\n          this.rePaintTrace()\r\n        }\r\n      }.bind(this)\r\n    },\r\n    /* 导入的图片显示在canvas上 */\r\n    drawImageOnCanvas () {\r\n      // this.clearCanvas()\r\n      // this.clearTrace()\r\n      this.image2Canvas()\r\n    },\r\n    /* 导入图片 */\r\n    imageInput () {\r\n      this.imageInputBtn.click()\r\n    },\r\n    /* test */\r\n    // findMark () {\r\n    //   var em = []\r\n    //   for (var i = 0; i < this.trace.length; i++) {\r\n    //     if (this.trace[i].end === true) {\r\n    //       em.push(i)\r\n    //     }\r\n    //   }\r\n    //   console.log(this.trace)\r\n    //   console.log(em)\r\n    // },\r\n    /* 撤回轨迹的上一步 切割数组 */\r\n    traceBackWard () {\r\n      if (this.trace.length === 0) {\r\n        alert('当前不存在可撤回轨迹')\r\n        return\r\n      }\r\n      var backFlag = true\r\n      // this.findMark()\r\n      // console.log(this.trace)\r\n      // 逆序遍历\r\n      for (var i = this.trace.length - 2; i >= 0; i--) {\r\n        if (this.trace[i].end === true) {\r\n          this.trace = this.trace.slice(0, i + 1)\r\n          backFlag = false\r\n          break\r\n        }\r\n      }\r\n      if (backFlag) {\r\n        this.trace = []\r\n      }\r\n\r\n      // this.findMark()\r\n      // console.log(this.trace)\r\n\r\n      this.rePaint() // 重新绘制之前的轨迹 也是在这一步导致导入的图片消失\r\n    },\r\n    /* 文件导入 */\r\n    fileInput () {\r\n      this.fileInputBtn.click() // 触发真正的文件导入按钮\r\n    },\r\n    /* 保存轨迹文件 */\r\n    saveTraceAsJSON () {\r\n      var content = JSON.stringify(this.trace) // 转换为JSON格式\r\n      // var content = JSON.stringify(\r\n      //   (this.ImageData = this.cxt.getImageData(\r\n      //     0,\r\n      //     0,\r\n      //     this.canvas.width,\r\n      //     this.canvas.height\r\n      //   ))\r\n      // )\r\n      // console.log(content)\r\n      var jsonLink = document.createElement('a')\r\n      jsonLink.download = 'trace.json'\r\n      var blob = new Blob([content]) // 字符内容变为blob地址\r\n      jsonLink.href = URL.createObjectURL(blob)\r\n      jsonLink.click()\r\n      this.$emit('uploadTraceJSONToFather', content)\r\n    },\r\n    /* 橡皮擦输入轨迹 */\r\n    eraserTraceInput (x, y) {\r\n      this.eraserTrace.push({ x: x, y: y })\r\n    },\r\n    /* 输入轨迹 */\r\n    traceInput (x, y, flag) {\r\n      this.trace.push({\r\n        x: x,\r\n        y: y,\r\n        end: flag\r\n      })\r\n    },\r\n    /* 利用轨迹数据重新绘制 */\r\n    rePaintTrace () {\r\n      var branchFlag = true\r\n      // 遍历轨迹对象\r\n      for (var i = 0; i < this.trace.length; i++) {\r\n        // console.log(this.trace[i])\r\n        if (branchFlag) {\r\n          this.beginAndMove(this.trace[i].x, this.trace[i].y)\r\n          branchFlag = false\r\n          continue\r\n        }\r\n        if (this.trace[i].end) {\r\n          branchFlag = true\r\n        }\r\n        this.draw(this.trace[i].x, this.trace[i].y)\r\n      }\r\n    },\r\n    rePaint () {\r\n      this.clearCanvas() // 重绘首先清空画布 这一步必须清除画布 因为撤回的原理是把分割后的数组重新绘制 这一步清空数组也导致了之前导入图片的消失\r\n\r\n      // 重画之前的图片 如果再这一步加重画图片 会导致之前的轨迹全部消失\r\n      if (this.imageToInsert) {\r\n        this.drawImageOnCanvas()\r\n      }\r\n      this.rePaintTrace()\r\n      // console.log(this.trace)\r\n      // console.log(this.trace)\r\n    },\r\n    /* 改变笔触颜色 注意要改两种颜色一种是线的颜色 一种时阴影的颜色 */\r\n    colorChange (color) {\r\n      this.cxt.strokeStyle = color\r\n      this.cxt.shadowColor = color\r\n    },\r\n    /* 改变笔触粗细 注意笔触属性接受值为number */\r\n    penSizeChange (width) {\r\n      // console.log(e) // e.data\r\n      // console.log(typeof this.lineWidth) //用户输入均为字符串\r\n      let lineWidth = Number(width)\r\n      if (lineWidth <= 0 || lineWidth > 10 || isNaN(lineWidth)) {\r\n        // 范围判定 只接受1-10\r\n        // console.log('请输入1-10以内的数值')\r\n        lineWidth = 5 // 恢复原值\r\n        this.cxt.lineWidth = lineWidth\r\n        return\r\n      }\r\n      this.cxt.lineWidth = lineWidth // 更改canvas设置\r\n    },\r\n    /* 改变保存图片类型 */\r\n    imgTypeChange (value) {\r\n      // console.log(value) //{key: \"jpeg\", label: \" jpg \"}\r\n      this.imageType = value.key\r\n    },\r\n    /* 获取DOM元素 */\r\n    getDOMEl () {\r\n      this.canvas = document.querySelector('#canvas')\r\n      this.fileInputBtn = document.querySelector('#fileInputBtn')\r\n      this.imageInputBtn = document.querySelector('#imageInputBtn')\r\n    },\r\n    /* canvas可用性测试 */\r\n    canvasSupTest () {\r\n      if (!(this.canvas.getContext && this.canvas.getContext('2d'))) {\r\n        const section = document.createElement('section') // 创建section元素\r\n        section.className = 'errorCanvas'\r\n        section.innerHTML = '对不起，当前浏览器不支持canvas'\r\n        this.canvas.prepend(section)\r\n        throw new Error('对不起，当前浏览器不支持canvas') // 终止代码运行\r\n      }\r\n    },\r\n    /* 属性初始化 */\r\n    porpertyInit (flag = false) {\r\n      // 这里设置宽高等于可见宽高很重要\r\n      // console.log('WindowclientWidth', document.body.clientWidth)\r\n      // console.log('WindowclientHeight', document.body.clientHeight)\r\n      // console.log('WindowclientWidth', this.canvas.clientWidth)\r\n      // console.log('WindowclientHeight', this.canvas.clientHeight)\r\n      // console.log(flag)\r\n      // if (flag) {\r\n      //   this.canvas.width = this.canvas.clientHeight\r\n      //   this.canvas.height = this.canvas.clientWidth\r\n      // } else {\r\n      //   this.canvas.width = this.canvas.clientWidth\r\n      //   this.canvas.height = this.canvas.clientHeight\r\n      // }\r\n\r\n      this.canvas.width = this.canvas.clientWidth\r\n      this.canvas.height = this.canvas.clientHeight\r\n\r\n      // console.log('Width', this.canvas.width)\r\n      // console.log('Height', this.canvas.height)\r\n\r\n      this.cxt = this.canvas.getContext('2d')\r\n      this.cxt.fillStyle = this.canvasBgColor // 填充颜色设定\r\n      this.cxt.fillRect(0, 0, this.canvas.width, this.canvas.height) // 画一个矩形 大小占满canvas 当做背景\r\n      this.cxt.strokeStyle = this.lineColor // 边框颜色设定\r\n      this.cxt.lineWidth = this.lineWidth // 线条粗细设定\r\n      this.cxt.lineCap = 'round' // 线条末端设定 为圆形\r\n      this.cxt.lineJoin = 'round' // 线条交汇处设定 为圆形边角\r\n      // 利用阴影 消除锯齿 注意颜色与线条颜色保持一致\r\n      this.cxt.shadowBlur = 1\r\n      this.cxt.shadowColor = this.lineColor\r\n    },\r\n    /* 创建路径与移动触点 */\r\n    beginAndMove (x, y) {\r\n      this.cxt.beginPath() // 创建新路径\r\n      this.cxt.moveTo(x, y) // 移动触点\r\n    },\r\n    /* 鼠标移动绘画 */\r\n    draw (x, y) {\r\n      this.cxt.lineTo(x, y)\r\n      this.cxt.stroke()\r\n    },\r\n    /* 闭合路径 PC请勿使用？ */\r\n    close () {\r\n      // this.cxt.closePath()\r\n    },\r\n    /* 下载签名并保存成图片 应该接收参数决定保存成图片的类型 */\r\n    download () {\r\n      if (this.imageType === 'jpg') {\r\n        var img = this.canvas.toDataURL('image/jpeg', 1)\r\n      } else if (this.imageType === 'png') {\r\n        img = this.canvas.toDataURL('image/png')\r\n      }\r\n\r\n      var downLoadLink = document.createElement('a')\r\n      downLoadLink.href = img\r\n      downLoadLink.download = 'mySignature'\r\n      downLoadLink.click() // 触发点击事件进行下载\r\n      this.$emit('uploadImageToFather', img)\r\n    },\r\n    clear () {\r\n      // this.clearTrace()\r\n      // 把导入的图片和画布一起清除\r\n      // this.image = ''\r\n      this.clearCanvas()\r\n      this.image = ''\r\n      // this.imageToInsert = ''\r\n      this.file = ''\r\n      this.newTrace = []\r\n    },\r\n    /* 清除当前canvas的内容 */\r\n    clearCanvas () {\r\n      this.cxt.clearRect(0, 0, this.canvas.width, this.canvas.height)\r\n      this.cxt.fillRect(0, 0, this.canvas.width, this.canvas.height) // 再绘制一次背景因为会连背景也清除\r\n    },\r\n    /* 清除当前轨迹数据 */\r\n    clearTrace () {\r\n      this.trace.splice(0, this.trace.length)\r\n      this.imageToInsert = ''\r\n      // this.trace = []\r\n      // this.clearCanvas()\r\n    },\r\n    /* canvas画布强制跟着窗口大小(建议每次加载强制触发) 未真机测试 */\r\n    windowToCanvas () {\r\n      console.log(window.innerWidth, window.innerHeight)\r\n      this.canvas.width = window.innerWidth\r\n      this.canvas.height = window.innerHeight\r\n    }\r\n  },\r\n  components: {},\r\n  mounted () {\r\n    this.getDOMEl() // 获取DOM元素\r\n    this.canvasSupTest() // canvas可用性测试\r\n    this.porpertyInit() // 初始化属性\r\n    this.mobileCompute() // 计算移动端偏移值\r\n    // 判断pc端还是移动端\r\n    if (this.isMobile()) {\r\n      /*\r\n      移动端  回调函数使用bind传入this\r\n    */\r\n      // 开始绘制 touchstart 手指触摸时触发\r\n      this.canvas.addEventListener(\r\n        'touchstart',\r\n\r\n        function (e) {\r\n          // console.log(e)\r\n          // console.log(e.changedTouches[0].pageX,event.changedTouches[0].pageY)\r\n          /*\r\n        e.changedTouches[0].pageX 触点的X坐标\r\n        e.changedTouches[0].pageY 触点的Y坐标\r\n        */\r\n          // console.log('start')\r\n          if (!this.eraserFlag) {\r\n            // console.log(e)\r\n            // console.log(test)\r\n            this.beginAndMove(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY\r\n            )\r\n            this.traceInput(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY,\r\n              false\r\n            ) // 记录鼠标开始时坐标\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      // 绘制中 touchmove 当手指在屏幕上滑动的时候连续地触发 思路为连续触发lineTo事件\r\n      this.canvas.addEventListener(\r\n        'touchmove',\r\n        function (e) {\r\n          // console.log('move')\r\n\r\n          if (!this.eraserFlag) {\r\n            // console.log(e.changedTouches[0].pageX,event.changedTouches[0].pageY)\r\n            this.traceInput(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY,\r\n              false\r\n            ) // 记录鼠标移动时坐标\r\n            this.draw(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY\r\n            )\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      // 结束绘制 闭合线路\r\n      this.canvas.addEventListener(\r\n        'touchend',\r\n        function (e) {\r\n          // console.log('end')\r\n\r\n          if (!this.eraserFlag) {\r\n            if (this.trace.length > 0) {\r\n              this.traceInput(\r\n                e.changedTouches[0].pageX - this.minusX,\r\n                e.changedTouches[0].pageY - this.minusY,\r\n                true\r\n              ) // 记录鼠标结束时坐标\r\n            }\r\n            this.draw(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY\r\n            )\r\n            // this.close()\r\n            // this.penShape() // 抬笔添加笔锋\r\n          }\r\n          // console.log('end', this.trace)\r\n        }.bind(this)\r\n      )\r\n      /* 禁止移动端默认拖拽事件 */\r\n      document.body.addEventListener(\r\n        'touchmove',\r\n        function (e) {\r\n          e.preventDefault()\r\n        },\r\n        { passive: false }\r\n      )\r\n      /* 移动端橡皮擦 */\r\n      this.canvas.addEventListener(\r\n        'touchstart',\r\n        function (e) {\r\n          if (this.eraserFlag) {\r\n            if (this.eraserTrace.length === 2) {\r\n              // 清除上一次的轨迹\r\n              this.eraserTrace = []\r\n            }\r\n            this.eraserTraceInput(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY\r\n            )\r\n            // console.log(this.eraserTrace)\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      this.canvas.addEventListener(\r\n        'touchend',\r\n        function (e) {\r\n          // console.log(this.eraserFlag)\r\n          if (this.eraserFlag) {\r\n            this.eraserTraceInput(\r\n              e.changedTouches[0].pageX - this.minusX,\r\n              e.changedTouches[0].pageY - this.minusY\r\n            )\r\n            // console.log(this.eraserTrace)\r\n            // 相交检测并根据检测结果擦除\r\n            this.eraserTheLine()\r\n            this.eraserTrace = []\r\n          }\r\n        }.bind(this)\r\n      )\r\n    } else {\r\n      /*\r\n      PC端  回调函数使用bind传入this\r\n    */\r\n      this.canvas.addEventListener(\r\n        'mousedown',\r\n        function (e) {\r\n          if (!this.eraserFlag) {\r\n            // console.log(e)\r\n            this.traceInput(e.layerX, e.layerY, false) // 记录鼠标开始时坐标\r\n            this.beginAndMove(e.layerX, e.layerY)\r\n            this.flag = true // 鼠标移动绘制时的标志量\r\n          }\r\n        }.bind(this)\r\n      )\r\n      this.canvas.addEventListener(\r\n        'mousemove',\r\n        function (e) {\r\n          if (!this.eraserFlag && this.flag) {\r\n            this.traceInput(e.layerX, e.layerY, false) // 记录鼠标移动时坐标\r\n            this.draw(e.layerX, e.layerY)\r\n          }\r\n        }.bind(this)\r\n      )\r\n      this.canvas.addEventListener(\r\n        // 这个事件很重要 否则在使用导航栏时会出现bug\r\n        'mouseout',\r\n        function (e) {\r\n          // this.traceInput(e.pageX, e.pageY, true)\r\n          this.flag = false // 标志归位\r\n        }.bind(this)\r\n      )\r\n      this.canvas.addEventListener(\r\n        'mouseup',\r\n        function (e) {\r\n          if (!this.eraserFlag) {\r\n            if (this.trace.length > 0) {\r\n              this.traceInput(e.layerX, e.layerY, true) // 记录鼠标结束时坐标\r\n            }\r\n            this.flag = false // 标志归位\r\n            this.draw(e.layerX, e.layerY)\r\n            // this.penShape() // 抬笔添加笔锋\r\n          }\r\n\r\n          // console.log(this.trace)\r\n        }.bind(this)\r\n      )\r\n\r\n      /* PC端橡皮擦 */\r\n      this.canvas.addEventListener(\r\n        'mousedown',\r\n        function (e) {\r\n          if (this.eraserFlag) {\r\n            if (this.eraserTrace.length === 2) {\r\n              // 清除上一次的轨迹\r\n              this.eraserTrace = []\r\n            }\r\n            this.eraserTraceInput(e.layerX, e.layerY)\r\n            // console.log(this.eraserTrace)\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      this.canvas.addEventListener(\r\n        'mouseup',\r\n        function (e) {\r\n          // console.log(this.eraserFlag)\r\n          if (this.eraserFlag) {\r\n            this.eraserTraceInput(e.layerX, e.layerY)\r\n            // console.log(this.eraserTrace)\r\n            // 相交检测并根据检测结果擦除\r\n            this.eraserTheLine()\r\n            this.eraserTrace = []\r\n          }\r\n        }.bind(this)\r\n      )\r\n    }\r\n\r\n    /* 检测窗口变化大小 如果发生变化会清除面板和重绘数据 */\r\n    window.addEventListener(\r\n      'orientationchange',\r\n      function () {\r\n        // orientationchange事件必须设置延迟 不然宽高获取会出错\r\n        // alert('resize')\r\n        setTimeout(() => {\r\n          this.mobileCompute() //\r\n          // console.log(this.minusX, this.minusY)\r\n          this.porpertyInit() // 需要重新初始化属性\r\n          this.rePaint()\r\n        }, 200)\r\n\r\n        // this.clearTrace() // 需要清除重绘数据\r\n      }.bind(this)\r\n    )\r\n    /* 文件选择并导入新轨迹 */\r\n    this.fileInputBtn.addEventListener(\r\n      'change',\r\n      function (e) {\r\n        this.file = e.target.files\r\n        // console.log(this.file)\r\n        const reader = new FileReader()\r\n        reader.readAsText(this.file[0])\r\n        reader.onload = function () {\r\n          this.newTrace = JSON.parse(reader.result)\r\n          this.trace = this.trace.concat(this.newTrace)\r\n        }.bind(this)\r\n      }.bind(this)\r\n    )\r\n    this.fileInputBtn.addEventListener('click', function (e) {\r\n      this.value = ''\r\n    })\r\n    /* 图片导入 */\r\n    this.imageInputBtn.addEventListener(\r\n      'change',\r\n      function (e) {\r\n        this.image = e.target.files\r\n        const reader = new FileReader()\r\n        reader.readAsDataURL(this.image[0])\r\n        reader.onload = function (e) {\r\n          this.imageToInsert = e.target.result\r\n          this.drawImageOnCanvas()\r\n          // console.log(this.imageToInsert)\r\n        }.bind(this)\r\n      }.bind(this)\r\n    )\r\n    this.imageInputBtn.addEventListener('click', function (e) {\r\n      this.value = ''\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#fileInputBtn {\r\n  position: absolute;\r\n  /* z-index: 99; */\r\n  left: 8px;\r\n  display: none;\r\n}\r\n.colorPicker {\r\n  position: absolute;\r\n  top: 50%;\r\n  transform: translate(0, -50%); /* 50%为自身尺寸的一半 */\r\n}\r\n\r\n.extra-show-item {\r\n  overflow: visible;\r\n}\r\n.pen-width-input {\r\n  width: 43px;\r\n}\r\n.btn-text {\r\n  margin-left: 0 !important;\r\n}\r\n.small-margin-right {\r\n  margin-right: 5px;\r\n}\r\n.small-width {\r\n  padding: 0 10px;\r\n}\r\n.menu-item {\r\n  padding: 5px;\r\n}\r\n.menu-item > span {\r\n  font-size: 15px;\r\n}\r\n.canvas-menu {\r\n  position: absolute;\r\n  top: 0;\r\n  z-index: 99;\r\n  width: 100%;\r\n}\r\n.canvas_container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.canvas_container canvas {\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n</style>\r\n\r\n<style>\r\n.m-colorPicker .box {\r\n  position: absolute;\r\n  left: -681%;\r\n  top: 169%;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SignatureCore.vue?vue&type=template&id=3c75e39c&scoped=true&\"\nimport script from \"./SignatureCore.vue?vue&type=script&lang=js&\"\nexport * from \"./SignatureCore.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SignatureCore.vue?vue&type=style&index=0&id=3c75e39c&scoped=true&lang=css&\"\nimport style1 from \"./SignatureCore.vue?vue&type=style&index=1&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3c75e39c\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"container\">\r\n    <el-menu class=\"el-menu-demo\" mode=\"horizontal\">\r\n      <el-menu-item class=\"menu-item\" index=\"1\"\r\n        ><el-button @click=\"download()\">保存</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"2\">\r\n        格式：\r\n        <el-select\r\n          class=\"selectModule\"\r\n          v-model=\"imageType\"\r\n          placeholder=\"请选择\"\r\n        >\r\n          <el-option\r\n            v-for=\"item in options\"\r\n            :key=\"item.vlaue\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value\"\r\n          >\r\n          </el-option>\r\n        </el-select>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"3\"\r\n        ><el-button @click=\"clear()\">清除</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"4\"\r\n        ><el-button\r\n          :type=\"btnHighlight || imgFlag ? 'primary' : ''\"\r\n          @click=\"repaint()\"\r\n          >重绘</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"5\"\r\n        ><el-button\r\n          :type=\"btnHighlight || imgFlag ? 'primary' : ''\"\r\n          @click=\"clearTrace()\"\r\n          >清除重绘</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"6\"\r\n        ><el-button\r\n          :type=\"btnHighlight || imgFlag ? 'primary' : ''\"\r\n          @click=\"saveTraceAsJSON()\"\r\n          >导出重绘</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\"\r\n        ><el-button @click=\"fileInput()\">导入重绘</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\" @click=\"imageInput()\"\r\n        ><el-button>导入图片</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\"\r\n        ><el-button @click=\"traceBackWard()\">撤回</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\"\r\n        ><el-button :type=\"eraserFlag ? 'primary' : ''\" @click=\"eraserTrigger()\"\r\n          >橡皮擦</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\"\r\n        ><el-button @click=\"penShape()\">笔锋</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\">\r\n        <span>粗细：</span>\r\n        <el-input\r\n          class=\"width-input\"\r\n          placeholder=\"输入粗细\"\r\n          v-model=\"width\"\r\n          clearable\r\n          @blur=\"penSizeChange(width)\"\r\n        >\r\n        </el-input>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"7\">\r\n        <span>颜色：</span>\r\n        <el-color-picker\r\n          @change=\"colorChange(color)\"\r\n          v-model=\"color\"\r\n        ></el-color-picker>\r\n      </el-menu-item>\r\n    </el-menu>\r\n    <signatureCore\r\n      @updateBtnHight=\"updateBtnHight\"\r\n      @updateImgFlag=\"updateImgFlag\"\r\n      @updateEraserFlag=\"updateEraserFlag\"\r\n      @uploadImageToFather=\"uploadImageToFather\"\r\n      @uploadTraceToFather=\"uploadTraceJSONToFather\"\r\n      :imageType=\"imageType\"\r\n      :lineWidth=\"Number(width)\"\r\n      :lineColor=\"color\"\r\n      ref=\"sigCore\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport signatureCore from './Signature/SignatureCore.vue'\r\nexport default {\r\n  data () {\r\n    return {\r\n      options: [\r\n        {\r\n          value: 'jpg',\r\n          label: 'jpg'\r\n        },\r\n        {\r\n          value: 'png',\r\n          label: 'png'\r\n        }\r\n      ],\r\n      imageType: '', // 传入子组件的图片类型\r\n      btnHighlight: false, // 按钮高亮标志量\r\n      eraserFlag: false, // 橡皮擦标志位\r\n      imgFlag: false, // 图片缓存标志量\r\n      width: 3, // 笔粗细\r\n      color: '#000' // 笔颜色\r\n    }\r\n  },\r\n  methods: {\r\n    /* 下载功能入口 */\r\n    download () {\r\n      this.$refs.sigCore.download()\r\n    },\r\n    /* 清除功能入口 */\r\n    clear () {\r\n      this.$refs.sigCore.clear()\r\n    },\r\n    /* 重绘功能入口 */\r\n    repaint () {\r\n      this.$refs.sigCore.rePaint()\r\n    },\r\n    /* 重绘导入功能入口 */\r\n    fileInput () {\r\n      this.$refs.sigCore.fileInput()\r\n    },\r\n    /* 清除重绘功能入口 */\r\n    clearTrace () {\r\n      this.$refs.sigCore.clearTrace()\r\n    },\r\n    /* 导出重绘功能入口 */\r\n    saveTraceAsJSON () {\r\n      this.$refs.sigCore.saveTraceAsJSON()\r\n    },\r\n    /* 导入图片功能入口 */\r\n    imageInput () {\r\n      this.$refs.sigCore.imageInput()\r\n    },\r\n    /* 撤回功能入口 */\r\n    traceBackWard () {\r\n      this.$refs.sigCore.traceBackWard()\r\n    },\r\n    /* 橡皮擦功能入口 */\r\n    eraserTrigger () {\r\n      this.$refs.sigCore.eraserTrigger()\r\n    },\r\n    /* 笔锋功能入口 */\r\n    penShape () {\r\n      this.$refs.sigCore.penShape()\r\n    },\r\n    /* 笔粗细改变功能入口 */\r\n    penSizeChange (width) {\r\n      this.$refs.sigCore.penSizeChange(width)\r\n    },\r\n    /* 笔颜色改变功能入口 */\r\n    colorChange (color) {\r\n      this.$refs.sigCore.colorChange(color)\r\n    },\r\n    /* 更新按钮标志量 */\r\n    updateBtnHight (newValue) {\r\n      this.btnHighlight = newValue\r\n    },\r\n    /* 更新图片标志量 */\r\n    updateImgFlag (newValue) {\r\n      this.imgFlag = newValue\r\n    },\r\n    /* 更新橡皮擦标志量 */\r\n    updateEraserFlag (newValue) {\r\n      console.log(newValue)\r\n      this.eraserFlag = newValue\r\n    },\r\n    // 内部图片传出\r\n    uploadImageToFather (img) {\r\n      // console.log(img)\r\n      this.img = img\r\n    },\r\n    // 内部json传出\r\n    uploadTraceJSONToFather (traceJSON) {\r\n      this.traceJSON = traceJSON\r\n      console.log(this.traceJSON)\r\n    },\r\n    injectJSON () { // 向手写板传入JSON\r\n      // 获取json文件的请求\r\n      var json = 'hello just test'\r\n      this.$refs.sigCore.injectJSON(json)\r\n    },\r\n    injectImage () { // 向手写板传入image\r\n      // 获取图片文件的请求\r\n      var image = 'hello I am image' // 格式 data:image/jpeg;base64\r\n      this.$refs.sigCore.injectImage(image)\r\n    }\r\n  },\r\n  components: { signatureCore }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.selectModule {\r\n  width: 100px;\r\n}\r\n.menu-item {\r\n  padding: 0 5px;\r\n}\r\n.width-input {\r\n  max-width: 80px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./elementUI.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./elementUI.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./elementUI.vue?vue&type=template&id=4899b1de&scoped=true&\"\nimport script from \"./elementUI.vue?vue&type=script&lang=js&\"\nexport * from \"./elementUI.vue?vue&type=script&lang=js&\"\nimport style0 from \"./elementUI.vue?vue&type=style&index=0&id=4899b1de&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4899b1de\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./elementUI.vue?vue&type=style&index=0&id=4899b1de&scoped=true&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=style&index=1&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=style&index=0&id=3c75e39c&scoped=true&lang=css&\""],"sourceRoot":""}