{"version":3,"sources":["webpack:///./src/views/Signature/SignatureCore.vue?23b9","webpack:///./src/views/elementUI.vue?e928","webpack:///./src/views/Signature/SignatureCore.vue?518c","webpack:///src/views/Signature/SignatureCore.vue","webpack:///./src/views/Signature/SignatureCore.vue?b622","webpack:///./src/views/Signature/SignatureCore.vue?6948","webpack:///src/views/elementUI.vue","webpack:///./src/views/elementUI.vue?ede6","webpack:///./src/views/elementUI.vue?9768","webpack:///./src/views/Signature/SignatureCore.vue?e7ea","webpack:///./src/views/Signature/eraser.png","webpack:///./src/views/elementUI.vue?0180"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","download","_v","model","value","callback","$$v","imageType","expression","_l","item","key","vlaue","label","clear","btnHighlight","imgFlag","repaint","clearTrace","saveTraceAsJSON","fileInput","imageInput","traceBackWard","eraserFlag","eraserTrigger","penShape","scaleUp","scaleDown","$event","penSizeChange","width","colorChange","color","_s","magnifi","ref","Number","updateBtnHight","updateImgFlag","updateEraserFlag","uploadImageToFather","uploadTraceJSONToFather","updateMagnifi","staticRenderFns","_m","staticStyle","props","lineWidth","type","default","lineColor","String","canvasBgColor","data","canvas","cxt","trace","flag","file","fileInputBtn","imageInputBtn","image","imageToInsert","newTrace","eraserTrace","minusX","minusY","watch","length","$emit","methods","scale","clearCanvas","drawImageOnCanvas","rePaintTrace","injectImage","injectJSON","JSON","parse","json","concat","mobileCompute","getBoundingClientRect","x","y","isMobile","penShapeCompute","j","end","index","push","len","branchFlag","beginAndMove","i","decay","draw","shift","image2Canvas","eraserTheLine","res","removeThisLine","judgeIntersect","conditon1","condition2","condition3","condition4","u","v","w","z","start","splice","rePaint","style","cursor","console","log","img","src","onload","drawImage","preColor","penFlag","click","slice","backFlag","alert","jsonLink","href","URL","createObjectURL","blob","content","eraserTraceInput","traceInputBegin","traceInput","strokeStyle","shadowColor","isNaN","imgTypeChange","getDOMEl","document","querySelector","canvasSupTest","getContext","section","className","innerHTML","prepend","Error","porpertyInit","clientWidth","height","clientHeight","fillStyle","fillRect","lineCap","lineJoin","shadowBlur","beginPath","moveTo","lineTo","stroke","close","toDataURL","downLoadLink","clearRect","components","mounted","addEventListener","body","window","e","component","options","$refs","sigCore","newValue","traceJSON","module","exports"],"mappings":"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","file":"js/chunk-287d0b8a.e9d03099.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=style&index=0&id=24a717d1&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('el-menu',{staticClass:\"el-menu-demo\",attrs:{\"mode\":\"horizontal\"}},[_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"1\"}},[_c('el-button',{on:{\"click\":_vm.download}},[_vm._v(\"保存\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"2\"}},[_vm._v(\" 格式： \"),_c('el-select',{staticClass:\"selectModule\",attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.imageType),callback:function ($$v) {_vm.imageType=$$v},expression:\"imageType\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.vlaue,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"3\"}},[_c('el-button',{on:{\"click\":_vm.clear}},[_vm._v(\"清除\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"4\"}},[_c('el-button',{attrs:{\"type\":_vm.btnHighlight || _vm.imgFlag ? 'primary' : ''},on:{\"click\":_vm.repaint}},[_vm._v(\"重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"5\"}},[_c('el-button',{attrs:{\"type\":_vm.btnHighlight || _vm.imgFlag ? 'primary' : ''},on:{\"click\":_vm.clearTrace}},[_vm._v(\"清除重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"6\"}},[_c('el-button',{attrs:{\"type\":_vm.btnHighlight || _vm.imgFlag ? 'primary' : ''},on:{\"click\":_vm.saveTraceAsJSON}},[_vm._v(\"导出重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"7\"}},[_c('el-button',{on:{\"click\":_vm.fileInput}},[_vm._v(\"导入重绘\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"8\"},on:{\"click\":_vm.imageInput}},[_c('el-button',[_vm._v(\"导入图片\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"9\"}},[_c('el-button',{on:{\"click\":_vm.traceBackWard}},[_vm._v(\"撤回\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"10\"}},[_c('el-button',{attrs:{\"type\":_vm.eraserFlag ? 'primary' : ''},on:{\"click\":_vm.eraserTrigger}},[_vm._v(\"橡皮擦\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"11\"}},[_c('el-button',{on:{\"click\":_vm.penShape}},[_vm._v(\"笔锋\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"12\"}},[_c('el-button',{on:{\"click\":_vm.scaleUp}},[_vm._v(\"放大\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"13\"}},[_c('el-button',{on:{\"click\":_vm.scaleDown}},[_vm._v(\"缩小\")])],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"14\"}},[_c('span',[_vm._v(\"粗细：\")]),_c('el-input',{staticClass:\"width-input\",attrs:{\"placeholder\":\"输入粗细\",\"clearable\":\"\"},on:{\"blur\":function($event){return _vm.penSizeChange(_vm.width)}},model:{value:(_vm.width),callback:function ($$v) {_vm.width=$$v},expression:\"width\"}})],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"15\"}},[_c('span',[_vm._v(\"颜色：\")]),_c('el-color-picker',{on:{\"change\":function($event){return _vm.colorChange(_vm.color)}},model:{value:(_vm.color),callback:function ($$v) {_vm.color=$$v},expression:\"color\"}})],1),_c('el-menu-item',{staticClass:\"menu-item\",attrs:{\"index\":\"16\"}},[_c('span',[_vm._v(\"放大倍数\"+_vm._s(_vm.magnifi))])])],1),_c('signatureCore',{ref:\"sigCore\",attrs:{\"imageType\":_vm.imageType,\"lineWidth\":Number(_vm.width),\"lineColor\":_vm.color},on:{\"updateBtnHight\":_vm.updateBtnHight,\"updateImgFlag\":_vm.updateImgFlag,\"updateEraserFlag\":_vm.updateEraserFlag,\"uploadImageToFather\":_vm.uploadImageToFather,\"uploadTraceToFather\":_vm.uploadTraceJSONToFather,\"updateMagnifi\":_vm.updateMagnifi}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"canvas_container\",attrs:{\"id\":\"canvas_container\"}},[_c('canvas',{attrs:{\"id\":\"canvas\"}}),_c('input',{attrs:{\"id\":\"fileInputBtn\",\"type\":\"file\",\"multiple\":\"\"}}),_c('input',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"imageInputBtn\",\"type\":\"file\",\"multiple\":\"\"}})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"canvas_container\" id=\"canvas_container\">\r\n    <canvas id=\"canvas\"></canvas>\r\n    <input id=\"fileInputBtn\" type=\"file\" multiple />\r\n    <input style=\"display: none\" id=\"imageInputBtn\" type=\"file\" multiple />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  // 暴露的参数\r\n  props: {\r\n    lineWidth: {\r\n      // 线条宽度 默认为5\r\n      type: Number,\r\n      default: 5\r\n    },\r\n    lineColor: {\r\n      // 线条颜色 默认黑色\r\n      type: String,\r\n      default: '#000'\r\n    },\r\n    canvasBgColor: {\r\n      // 绘画框背景颜色\r\n      type: String,\r\n      default: '#fff'\r\n    },\r\n    imageType: {\r\n      // 默认的图片类型\r\n      type: String,\r\n      default: 'jpg'\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      canvas: '', // canvas画布\r\n      cxt: '', // canvas的context,\r\n      trace: [], // 轨迹变量数据\r\n      flag: '', // 鼠标移动时的标志量\r\n      btnHighlight: false, // 按钮高亮标志量\r\n      imgFlag: false, // 图片功能关联的重绘和消除重绘高亮\r\n      file: '', // 传入的文件\r\n      fileInputBtn: '', // 文件选择输入按钮\r\n      imageInputBtn: '', // 图片选择输入按扭\r\n      image: '', // 导入的图片\r\n      imageToInsert: '', // 要导入canvas的图片\r\n      newTrace: '', // 导入的新轨迹\r\n      eraserFlag: false, // 橡皮擦功能启动标志位\r\n      eraserTrace: [], // 橡皮擦轨迹\r\n      minusX: '', // 移动端画布x轴偏移值\r\n      minusY: '', // 移动端画布y轴偏移值\r\n      color: this.lineColor,\r\n      width: this.lineWidth,\r\n      magnifi: 1\r\n    }\r\n  },\r\n  watch: {\r\n    trace () {\r\n      // 只能使用watcher 如果在按钮属性直接使用三元表达式会导致书写卡顿\r\n      if (this.trace.length > 0) {\r\n        this.btnHighlight = true\r\n      } else {\r\n        this.btnHighlight = false\r\n      }\r\n      this.$emit('updateBtnHight', this.btnHighlight) // 同时向外部更新\r\n    },\r\n    imageToInsert () {\r\n      if (this.imageToInsert) {\r\n        this.imgFlag = true\r\n      } else {\r\n        this.imgFlag = false\r\n      }\r\n      this.$emit('updateImgFlag', this.imgFlag) // 同时向外部更新\r\n    }\r\n  },\r\n  methods: {\r\n    /* 缩小 */\r\n    scaleDown () {\r\n      this.magnifi /= 2\r\n      this.cxt.scale(0.5, 0.5)\r\n      this.clearCanvas()\r\n      if (this.imageToInsert) {\r\n        this.drawImageOnCanvas()\r\n      }\r\n      this.rePaintTrace()\r\n      this.$emit('updateMagnifi', this.magnifi)\r\n      // console.log(this.canvas.width, this.canvas.height)\r\n    },\r\n    /* 放大 */\r\n    scaleUp () {\r\n      this.magnifi *= 2\r\n\r\n      this.cxt.scale(2, 2)\r\n      this.clearCanvas()\r\n      if (this.imageToInsert) {\r\n        this.drawImageOnCanvas()\r\n      }\r\n      this.rePaintTrace()\r\n      this.$emit('updateMagnifi', this.magnifi)\r\n      // console.log(this.canvas.width, this.canvas.height)\r\n    },\r\n\r\n    /* 外部图片传入 */\r\n    injectImage (image) {\r\n      // console.log(image)\r\n      this.imageToInsert = image\r\n      this.drawImageOnCanvas()\r\n    },\r\n    /* 外部JSON传入 */\r\n    injectJSON (json) {\r\n      // console.log(json)\r\n      this.newTrace = JSON.parse(json)\r\n      this.trace = this.trace.concat(this.newTrace)\r\n    },\r\n    /* 计算移动端偏移值 */\r\n    mobileCompute (flag = false) {\r\n      this.minusX = this.canvas.getBoundingClientRect().x\r\n      this.minusY = this.canvas.getBoundingClientRect().y\r\n    },\r\n    /* 判断浏览器是pc端还是移动端 */\r\n    isMobile () {\r\n      if (\r\n        window.navigator.userAgent.match(\r\n          /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i\r\n        )\r\n      ) {\r\n        return true // 移动端\r\n      } else {\r\n        return false // PC端\r\n      }\r\n    },\r\n    /* 笔锋测试 核心思路为线的宽度逐渐减少 */\r\n    penShapeCompute () {\r\n      const index = [] // 每条线段的终点坐标\r\n      const len = []\r\n      for (let j = 0; j < this.trace.length; j++) {\r\n        if (this.trace[j].end) {\r\n          index.push(j)\r\n        }\r\n      }\r\n      // console.log(index)\r\n      // 计算每段线段的长度\r\n\r\n      len[0] = index[0] + 1\r\n      for (let j = 1; j < index.length; j++) {\r\n        len.push(index[j] - index[j - 1])\r\n      }\r\n\r\n      // console.log(len)\r\n      // var count = 0\r\n      let decay = (this.lineWidth - 1) / len[0] // 宽度衰减值\r\n      // console.log(decay)\r\n      let branchFlag = true\r\n      // 遍历轨迹对象\r\n      for (let i = 0; i < this.trace.length; i++) {\r\n        // console.log(this.trace[i])\r\n        if (branchFlag) {\r\n          this.beginAndMove(this.trace[i].x, this.trace[i].y)\r\n          branchFlag = false\r\n          continue\r\n        }\r\n\r\n        // 逐渐改变线的宽度\r\n        this.cxt.lineWidth -= decay\r\n        // console.log(this.cxt.lineWidth)\r\n        this.draw(this.trace[i].x, this.trace[i].y)\r\n        if (this.trace[i].end) {\r\n          branchFlag = true\r\n          this.cxt.lineWidth = this.lineWidth\r\n          len.shift()\r\n          decay = (this.lineWidth - 1) / len[0]\r\n          // count += 1\r\n          // console.log(decay)\r\n        }\r\n      }\r\n      // console.log(count)\r\n    },\r\n    penShape () {\r\n      this.clearCanvas()\r\n      this.penShapeCompute()\r\n      this.image2Canvas(true)\r\n    },\r\n    /* 遍历轨迹数组 并根据检测结果擦除 */\r\n    eraserTheLine () {\r\n      for (let i = 0; i < this.trace.length - 1; i++) {\r\n        // 第一个点不能是终点 以防错误连线检测\r\n        if (!this.trace[i].end) {\r\n          // 相交检测\r\n          const x1 = this.eraserTrace[0].x\r\n          const y1 = this.eraserTrace[0].y\r\n          const x2 = this.eraserTrace[1].x\r\n          const y2 = this.eraserTrace[1].y\r\n          const x3 = this.trace[i].x\r\n          const y3 = this.trace[i].y\r\n          const x4 = this.trace[i + 1].x\r\n          const y4 = this.trace[i + 1].y\r\n          const res = this.judgeIntersect(x1, y1, x2, y2, x3, y3, x4, y4)\r\n          if (res) {\r\n            this.removeThisLine(i)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    /* 四点两两连线线段相交检测 注意传入参数的顺序 */\r\n    judgeIntersect (x1, y1, x2, y2, x3, y3, x4, y4) {\r\n      // 快速排斥\r\n      // 两个线段为对角线组成的矩形，如果两个矩形没有重叠的部分，那么两条线段一定不相交（但是重叠的矩形也有可能不相交）\r\n\r\n      // 1. 线段ab的低点低于cd的最高点（可能重合）\r\n      const conditon1 = Math.min(y1, y2) <= Math.max(y3, y4)\r\n      // 2. cd最左端小于ab最右端\r\n      const condition2 = Math.min(x3, x4) < Math.max(x1, x2)\r\n      // 3. cd的最低点低于ab的最高点（加上条件1，两线段在竖直方向上重合）\r\n      const condition3 = Math.min(y3, y4) < Math.max(y1, y2)\r\n      // 4. ab的最左端小于cd的最右端\r\n      const condition4 = Math.min(x1, x2) < Math.max(x3, x4)\r\n\r\n      // 综合以上4个条件 矩形是重合的（也包括矩形包含的情况） 这一步是判断那些绝对不重合的矩阵 即绝对不相交\r\n      if (!(conditon1 && condition2 && condition3 && condition4)) {\r\n        return false\r\n      }\r\n\r\n      // 剩下的用跨立实验判断\r\n      // 如果两条线段相交 必然跨立，以一条线段为标准，另一条线段的两端点一定在这条线段的两端\r\n      // 即ab两点在线段cd的两端 cd两点在线段ab的两端\r\n      // (ACxAB)*(ABxAD) <= 0\r\n      // AC AB 叉乘<=0\r\n      // AB AD 叉乘<=0\r\n\r\n      // AC AB 叉乘 详见向量公式以及叉乘公式\r\n      const u = (x3 - x1) * (y2 - y1) - (x2 - x1) * (y3 - y1)\r\n      // AD AB 叉乘\r\n      const v = (x4 - x1) * (y2 - y1) - (x2 - x1) * (y4 - y1)\r\n      // 以下同理 即对于另一条线段也要判断是否在两侧\r\n      const w = (x1 - x3) * (y4 - y3) - (x4 - x3) * (y1 - y3)\r\n      const z = (x2 - x3) * (y4 - y3) - (x4 - x3) * (y2 - y3)\r\n      return u * v <= 0.00000001 && w * z <= 0.00000001\r\n    },\r\n    /* 传入坐标 移除该坐标所在的线段 */\r\n    removeThisLine (index) {\r\n      let start = 0\r\n      let end = 0\r\n      for (let i = index; i >= 0; i--) {\r\n        if (this.trace[i].end) {\r\n          start = i + 1\r\n          break\r\n        }\r\n      }\r\n      for (let i = index; i < this.trace.length; i++) {\r\n        if (this.trace[i].end) {\r\n          end = i\r\n          break\r\n        }\r\n      }\r\n      this.trace.splice(start, end - start + 1)\r\n      // console.log(this.trace)\r\n      this.rePaint()\r\n    },\r\n    eraserTrigger () {\r\n      this.eraserFlag = !this.eraserFlag\r\n      const cursorIcon = require('./eraser.png') // base64\r\n      this.canvas.style.cursor = this.eraserFlag\r\n        ? `url(${cursorIcon}),auto`\r\n        : 'default'\r\n      this.$emit('updateEraserFlag', this.eraserFlag)\r\n      this.eraserTrace = [] // 清空上一次的橡皮擦轨迹数组\r\n    },\r\n    image2Canvas (penFlag) {\r\n      const img = new Image()\r\n      console.log(this.imageToInsert)\r\n      img.src = this.imageToInsert\r\n      // 异步事件的使用要特别注意\r\n      img.onload = function () {\r\n        // this.cxt.drawImage(img, 0, 0, this.canvas.width, this.canvas.height)\r\n        const preColor = this.color\r\n        this.colorChange('#FFFFFF')\r\n        this.cxt.drawImage(img, 0, 0)\r\n        this.colorChange(preColor)\r\n        // 重画之前的轨迹\r\n        if (this.trace.length > 0 && penFlag) {\r\n          this.penShapeCompute()\r\n        } else {\r\n          this.rePaintTrace()\r\n        }\r\n      }.bind(this)\r\n    },\r\n    /* 导入的图片显示在canvas上 */\r\n    drawImageOnCanvas () {\r\n      // this.clearCanvas()\r\n      // this.clearTrace()\r\n      this.image2Canvas()\r\n    },\r\n    /* 导入图片 */\r\n    imageInput () {\r\n      this.imageInputBtn.click()\r\n    },\r\n    /* test */\r\n    // findMark () {\r\n    //   var em = []\r\n    //   for (var i = 0; i < this.trace.length; i++) {\r\n    //     if (this.trace[i].end === true) {\r\n    //       em.push(i)\r\n    //     }\r\n    //   }\r\n    //   console.log(this.trace)\r\n    //   console.log(em)\r\n    // },\r\n    /* 撤回轨迹的上一步 切割数组 */\r\n    traceBackWard () {\r\n      if (this.trace.length === 0) {\r\n        alert('当前不存在可撤回轨迹')\r\n        return\r\n      }\r\n      let backFlag = true\r\n      // this.findMark()\r\n      // console.log(this.trace)\r\n      // 逆序遍历\r\n      for (let i = this.trace.length - 2; i >= 0; i--) {\r\n        if (this.trace[i].end === true) {\r\n          this.trace = this.trace.slice(0, i + 1)\r\n          backFlag = false\r\n          break\r\n        }\r\n      }\r\n      if (backFlag) {\r\n        this.trace = []\r\n      }\r\n      this.rePaint() // 重新绘制之前的轨迹 也是在这一步导致导入的图片消失\r\n    },\r\n    /* 文件导入 */\r\n    fileInput () {\r\n      this.fileInputBtn.click() // 触发真正的文件导入按钮\r\n    },\r\n    /* 保存轨迹文件 */\r\n    saveTraceAsJSON () {\r\n      const content = JSON.stringify(this.trace) // 转换为JSON格式\r\n      const jsonLink = document.createElement('a')\r\n      jsonLink.download = 'trace.json'\r\n      const blob = new Blob([content]) // 字符内容变为blob地址\r\n      jsonLink.href = URL.createObjectURL(blob)\r\n      jsonLink.click()\r\n      this.$emit('uploadTraceJSONToFather', content)\r\n    },\r\n    /* 橡皮擦输入轨迹 */\r\n    eraserTraceInput (x, y) {\r\n      this.eraserTrace.push({ x: x, y: y })\r\n    },\r\n    /* 输入轨迹起点 起点记录标志位 颜色 宽度 */\r\n    traceInputBegin (x, y, flag, color, width) {\r\n      this.trace.push({\r\n        x: x,\r\n        y: y,\r\n        start: flag,\r\n        color: color,\r\n        width: width\r\n      })\r\n    },\r\n    /* 输入轨迹 */\r\n    traceInput (x, y, flag) {\r\n      this.trace.push({\r\n        x: x,\r\n        y: y,\r\n        end: flag\r\n      })\r\n    },\r\n    /* 利用轨迹数据重新绘制 */\r\n    rePaintTrace () {\r\n      let branchFlag = true\r\n      // 遍历轨迹对象\r\n      for (let i = 0; i < this.trace.length; i++) {\r\n        // console.log(this.trace[i])\r\n        if (branchFlag) {\r\n          this.beginAndMove(this.trace[i].x, this.trace[i].y)\r\n          branchFlag = false\r\n          if (this.trace[i].start) {\r\n            this.colorChange(this.trace[i].color)\r\n            this.penSizeChange(this.trace[i].width)\r\n          }\r\n          continue\r\n        }\r\n        if (this.trace[i].end) {\r\n          branchFlag = true\r\n        }\r\n        this.draw(this.trace[i].x, this.trace[i].y)\r\n      }\r\n    },\r\n    rePaint () {\r\n      this.clearCanvas() // 重绘首先清空画布 这一步必须清除画布 因为撤回的原理是把分割后的数组重新绘制 这一步清空数组也导致了之前导入图片的消失\r\n\r\n      // 重画之前的图片 如果再这一步加重画图片 会导致之前的轨迹全部消失\r\n      if (this.imageToInsert) {\r\n        this.drawImageOnCanvas()\r\n      }\r\n      this.rePaintTrace()\r\n      // console.log(this.trace)\r\n      // console.log(this.trace)\r\n    },\r\n    /* 改变笔触颜色 注意要改两种颜色一种是线的颜色 一种时阴影的颜色 */\r\n    colorChange (color) {\r\n      this.color = color\r\n      this.cxt.strokeStyle = this.color\r\n      this.cxt.shadowColor = this.color\r\n    },\r\n    /* 改变笔触粗细 注意笔触属性接受值为number */\r\n    penSizeChange (width) {\r\n      // console.log(e) // e.data\r\n      // console.log(typeof this.lineWidth) //用户输入均为字符串\r\n      this.width = width\r\n      let lineWidth = Number(this.width)\r\n      if (lineWidth <= 0 || lineWidth > 10 || isNaN(lineWidth)) {\r\n        // 范围判定 只接受1-10\r\n        // console.log('请输入1-10以内的数值')\r\n        lineWidth = 5 // 恢复原值\r\n        this.cxt.lineWidth = lineWidth\r\n        return\r\n      }\r\n      this.cxt.lineWidth = lineWidth // 更改canvas设置\r\n    },\r\n    /* 改变保存图片类型 */\r\n    imgTypeChange (value) {\r\n      // console.log(value) //{key: \"jpeg\", label: \" jpg \"}\r\n      this.imageType = value.key\r\n    },\r\n    /* 获取DOM元素 */\r\n    getDOMEl () {\r\n      this.canvas = document.querySelector('#canvas')\r\n      this.fileInputBtn = document.querySelector('#fileInputBtn')\r\n      this.imageInputBtn = document.querySelector('#imageInputBtn')\r\n    },\r\n    /* canvas可用性测试 */\r\n    canvasSupTest () {\r\n      if (!(this.canvas.getContext && this.canvas.getContext('2d'))) {\r\n        const section = document.createElement('section') // 创建section元素\r\n        section.className = 'errorCanvas'\r\n        section.innerHTML = '对不起，当前浏览器不支持canvas'\r\n        this.canvas.prepend(section)\r\n        throw new Error('对不起，当前浏览器不支持canvas') // 终止代码运行\r\n      }\r\n    },\r\n    /* 属性初始化 */\r\n    porpertyInit (flag = false) {\r\n      // 这里设置宽高等于可见宽高很重要\r\n      this.canvas.width = this.canvas.clientWidth\r\n      this.canvas.height = this.canvas.clientHeight\r\n      this.cxt = this.canvas.getContext('2d')\r\n      this.cxt.fillStyle = this.canvasBgColor // 填充颜色设定\r\n      this.cxt.fillRect(0, 0, this.canvas.width, this.canvas.height) // 画一个矩形 大小占满canvas 当做背景\r\n      // this.drawBackground()\r\n      this.cxt.strokeStyle = this.lineColor // 边框颜色设定\r\n      this.cxt.lineWidth = this.lineWidth // 线条粗细设定\r\n      this.cxt.lineCap = 'round' // 线条末端设定 为圆形\r\n      this.cxt.lineJoin = 'round' // 线条交汇处设定 为圆形边角\r\n      // 利用阴影 消除锯齿 注意颜色与线条颜色保持一致\r\n      this.cxt.shadowBlur = 1\r\n      this.cxt.shadowColor = this.lineColor\r\n    },\r\n    /* 创建路径与移动触点 */\r\n    beginAndMove (x, y) {\r\n      this.cxt.beginPath() // 创建新路径\r\n      this.cxt.moveTo(x, y) // 移动触点\r\n    },\r\n    /* 鼠标移动绘画 */\r\n    draw (x, y) {\r\n      this.cxt.lineTo(x, y)\r\n      this.cxt.stroke()\r\n    },\r\n    /* 闭合路径 PC请勿使用？ */\r\n    close () {\r\n      // this.cxt.closePath()\r\n    },\r\n    /* 下载签名并保存成图片 应该接收参数决定保存成图片的类型 */\r\n    download () {\r\n      let img = ''\r\n      if (this.imageType === 'jpg') {\r\n        img = this.canvas.toDataURL('image/jpeg', 1)\r\n      } else if (this.imageType === 'png') {\r\n        img = this.canvas.toDataURL('image/png')\r\n      }\r\n      const downLoadLink = document.createElement('a')\r\n      downLoadLink.download = 'mySignature'\r\n      downLoadLink.href = img\r\n      // console.log(downLoadLink)\r\n      downLoadLink.click() // 触发点击事件进行下载\r\n      this.$emit('uploadImageToFather', img)\r\n    },\r\n    clear () {\r\n      // this.clearTrace()\r\n      // 把导入的图片和画布一起清除\r\n      // this.image = ''\r\n      this.clearCanvas()\r\n      this.image = ''\r\n      // this.imageToInsert = ''\r\n      this.file = ''\r\n      this.newTrace = []\r\n    },\r\n    /* 清除当前canvas的内容 */\r\n    clearCanvas () {\r\n      this.cxt.clearRect(\r\n        0,\r\n        0,\r\n        this.canvas.width / this.magnifi,\r\n        this.canvas.height / this.magnifi\r\n      )\r\n\r\n      this.cxt.fillRect(\r\n        0,\r\n        0,\r\n        this.canvas.width / this.magnifi,\r\n        this.canvas.height / this.magnifi\r\n      ) // 再绘制一次背景因为会连背景也清除\r\n      // this.drawBackground()\r\n    },\r\n    /* 清除当前轨迹数据 */\r\n    clearTrace () {\r\n      this.trace.splice(0, this.trace.length)\r\n      this.imageToInsert = ''\r\n      // this.trace = []\r\n      // this.clearCanvas()\r\n    }\r\n  },\r\n  components: {},\r\n  mounted () {\r\n    this.getDOMEl() // 获取DOM元素\r\n    this.canvasSupTest() // canvas可用性测试\r\n    this.porpertyInit() // 初始化属性\r\n    this.mobileCompute() // 计算移动端偏移值\r\n    // 判断pc端还是移动端\r\n    if (this.isMobile()) {\r\n      /*\r\n      移动端  回调函数使用bind传入this\r\n    */\r\n      // 开始绘制 touchstart 手指触摸时触发\r\n      this.canvas.addEventListener(\r\n        'touchstart',\r\n\r\n        function (e) {\r\n          // console.log(e)\r\n          // console.log(e.changedTouches[0].pageX,event.changedTouches[0].pageY)\r\n          /*\r\n        e.changedTouches[0].pageX 触点的X坐标\r\n        e.changedTouches[0].pageY 触点的Y坐标\r\n        */\r\n          // console.log('start')\r\n          if (!this.eraserFlag) {\r\n            const X = (e.changedTouches[0].pageX - this.minusX) / this.magnifi\r\n            const Y = (e.changedTouches[0].pageY - this.minusY) / this.magnifi\r\n            this.beginAndMove(X, Y)\r\n            this.traceInputBegin(X, Y, true, this.color, this.width) // 记录鼠标开始时坐标\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      // 绘制中 touchmove 当手指在屏幕上滑动的时候连续地触发 思路为连续触发lineTo事件\r\n      this.canvas.addEventListener(\r\n        'touchmove',\r\n        function (e) {\r\n          if (!this.eraserFlag) {\r\n            const X = (e.changedTouches[0].pageX - this.minusX) / this.magnifi\r\n            const Y = (e.changedTouches[0].pageY - this.minusY) / this.magnifi\r\n            this.traceInput(X, Y, false) // 记录鼠标移动时坐标\r\n            this.draw(X, Y)\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      // 结束绘制 闭合线路\r\n      this.canvas.addEventListener(\r\n        'touchend',\r\n        function (e) {\r\n          if (!this.eraserFlag) {\r\n            const X = (e.changedTouches[0].pageX - this.minusX) / this.magnifi\r\n            const Y = (e.changedTouches[0].pageY - this.minusY) / this.magnifi\r\n            if (this.trace.length > 0) {\r\n              this.traceInput(X, Y, true) // 记录鼠标结束时坐标\r\n            }\r\n            this.draw(X, Y)\r\n            // this.close()\r\n            // this.penShape() // 抬笔添加笔锋\r\n          }\r\n          // console.log('end', this.trace)\r\n        }.bind(this)\r\n      )\r\n      /* 禁止移动端默认拖拽事件 */\r\n      document.body.addEventListener(\r\n        'touchmove',\r\n        function (e) {\r\n          e.preventDefault()\r\n        },\r\n        { passive: false }\r\n      )\r\n      /* 移动端橡皮擦 */\r\n      this.canvas.addEventListener(\r\n        'touchstart',\r\n        function (e) {\r\n          if (this.eraserFlag) {\r\n            const X = (e.changedTouches[0].pageX - this.minusX) / this.magnifi\r\n            const Y = (e.changedTouches[0].pageY - this.minusY) / this.magnifi\r\n            if (this.eraserTrace.length === 2) {\r\n              // 清除上一次的轨迹\r\n              this.eraserTrace = []\r\n            }\r\n            this.eraserTraceInput(X, Y)\r\n            // console.log(this.eraserTrace)\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      this.canvas.addEventListener(\r\n        'touchend',\r\n        function (e) {\r\n          // console.log(this.eraserFlag)\r\n          if (this.eraserFlag) {\r\n            const X = (e.changedTouches[0].pageX - this.minusX) / this.magnifi\r\n            const Y = (e.changedTouches[0].pageY - this.minusY) / this.magnifi\r\n            this.eraserTraceInput(X, Y)\r\n            // console.log(this.eraserTrace)\r\n            // 相交检测并根据检测结果擦除\r\n            this.eraserTheLine()\r\n            this.eraserTrace = []\r\n          }\r\n        }.bind(this)\r\n      )\r\n    } else {\r\n      /*\r\n      PC端  回调函数使用bind传入this\r\n    */\r\n      this.canvas.addEventListener(\r\n        'mousedown',\r\n        function (e) {\r\n          // console.log(e)\r\n          if (!this.eraserFlag) {\r\n            const X = e.layerX / this.magnifi\r\n            const Y = e.layerY / this.magnifi\r\n            this.traceInputBegin(X, Y, true, this.color, this.width) // 记录鼠标开始时坐标\r\n            this.beginAndMove(X, Y)\r\n            this.flag = true // 鼠标移动绘制时的标志量\r\n          }\r\n        }.bind(this)\r\n      )\r\n      this.canvas.addEventListener(\r\n        'mousemove',\r\n        function (e) {\r\n          if (!this.eraserFlag && this.flag) {\r\n            const X = e.layerX / this.magnifi\r\n            const Y = e.layerY / this.magnifi\r\n            this.traceInput(X, Y, false) // 记录鼠标移动时坐标\r\n            this.draw(X, Y)\r\n          }\r\n        }.bind(this)\r\n      )\r\n      this.canvas.addEventListener(\r\n        // 这个事件很重要 否则在使用导航栏时会出现bug\r\n        'mouseout',\r\n        function (e) {\r\n          // this.traceInput(e.pageX, e.pageY, true)\r\n          this.flag = false // 标志归位\r\n        }.bind(this)\r\n      )\r\n      this.canvas.addEventListener(\r\n        'mouseup',\r\n        function (e) {\r\n          if (!this.eraserFlag) {\r\n            const X = e.layerX / this.magnifi\r\n            const Y = e.layerY / this.magnifi\r\n            if (this.trace.length > 0) {\r\n              this.traceInput(X, Y, true) // 记录鼠标结束时坐标\r\n            }\r\n            this.flag = false // 标志归位\r\n            this.draw(X, Y)\r\n            // this.penShape() // 抬笔添加笔锋\r\n          }\r\n\r\n          // console.log(this.trace)\r\n        }.bind(this)\r\n      )\r\n\r\n      /* PC端橡皮擦 */\r\n      this.canvas.addEventListener(\r\n        'mousedown',\r\n        function (e) {\r\n          if (this.eraserFlag) {\r\n            const X = e.layerX / this.magnifi\r\n            const Y = e.layerY / this.magnifi\r\n            if (this.eraserTrace.length === 2) {\r\n              // 清除上一次的轨迹\r\n              this.eraserTrace = []\r\n            }\r\n            this.eraserTraceInput(X, Y)\r\n            // console.log(this.eraserTrace)\r\n          }\r\n        }.bind(this)\r\n      )\r\n\r\n      this.canvas.addEventListener(\r\n        'mouseup',\r\n        function (e) {\r\n          // console.log(this.eraserFlag)\r\n          if (this.eraserFlag) {\r\n            const X = e.layerX / this.magnifi\r\n            const Y = e.layerY / this.magnifi\r\n            this.eraserTraceInput(X, Y)\r\n            // console.log(this.eraserTrace)\r\n            // 相交检测并根据检测结果擦除\r\n            this.eraserTheLine()\r\n            this.eraserTrace = []\r\n          }\r\n        }.bind(this)\r\n      )\r\n    }\r\n\r\n    /* 检测窗口变化大小 如果发生变化会清除面板和重绘数据 */\r\n    window.addEventListener(\r\n      'orientationchange',\r\n      function () {\r\n        // orientationchange事件必须设置延迟 不然宽高获取会出错\r\n        // alert('resize')\r\n        setTimeout(() => {\r\n          this.mobileCompute() //\r\n          // console.log(this.minusX, this.minusY)\r\n          this.porpertyInit() // 需要重新初始化属性\r\n          this.rePaint()\r\n        }, 200)\r\n\r\n        // this.clearTrace() // 需要清除重绘数据\r\n      }.bind(this)\r\n    )\r\n    /* 文件选择并导入新轨迹 */\r\n    this.fileInputBtn.addEventListener(\r\n      'change',\r\n      function (e) {\r\n        this.file = e.target.files\r\n        // console.log(this.file)\r\n        const reader = new FileReader()\r\n        reader.readAsText(this.file[0])\r\n        reader.onload = function () {\r\n          this.newTrace = JSON.parse(reader.result)\r\n          this.trace = this.trace.concat(this.newTrace)\r\n        }.bind(this)\r\n      }.bind(this)\r\n    )\r\n    this.fileInputBtn.addEventListener('click', function (e) {\r\n      this.value = ''\r\n    })\r\n    /* 图片导入 */\r\n    this.imageInputBtn.addEventListener(\r\n      'change',\r\n      function (e) {\r\n        this.image = e.target.files\r\n        const reader = new FileReader()\r\n        reader.readAsDataURL(this.image[0])\r\n        reader.onload = function (e) {\r\n          this.imageToInsert = e.target.result\r\n          // console.log(this.imageToInsert)\r\n          this.drawImageOnCanvas()\r\n        }.bind(this)\r\n      }.bind(this)\r\n    )\r\n    this.imageInputBtn.addEventListener('click', function (e) {\r\n      this.value = ''\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#fileInputBtn {\r\n  position: absolute;\r\n  /* z-index: 99; */\r\n  left: 8px;\r\n  display: none;\r\n}\r\n.colorPicker {\r\n  position: absolute;\r\n  top: 50%;\r\n  transform: translate(0, -50%); /* 50%为自身尺寸的一半 */\r\n}\r\n\r\n.extra-show-item {\r\n  overflow: visible;\r\n}\r\n.pen-width-input {\r\n  width: 43px;\r\n}\r\n.btn-text {\r\n  margin-left: 0 !important;\r\n}\r\n.small-margin-right {\r\n  margin-right: 5px;\r\n}\r\n.small-width {\r\n  padding: 0 10px;\r\n}\r\n.menu-item {\r\n  padding: 5px;\r\n}\r\n.menu-item > span {\r\n  font-size: 15px;\r\n}\r\n.canvas-menu {\r\n  position: absolute;\r\n  top: 0;\r\n  z-index: 99;\r\n  width: 100%;\r\n}\r\n.canvas_container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.canvas_container canvas {\r\n  display: block;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n</style>\r\n\r\n<style>\r\n.m-colorPicker .box {\r\n  position: absolute;\r\n  left: -681%;\r\n  top: 169%;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SignatureCore.vue?vue&type=template&id=24a717d1&scoped=true&\"\nimport script from \"./SignatureCore.vue?vue&type=script&lang=js&\"\nexport * from \"./SignatureCore.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SignatureCore.vue?vue&type=style&index=0&id=24a717d1&scoped=true&lang=css&\"\nimport style1 from \"./SignatureCore.vue?vue&type=style&index=1&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"24a717d1\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"container\">\r\n    <el-menu class=\"el-menu-demo\" mode=\"horizontal\">\r\n      <el-menu-item class=\"menu-item\" index=\"1\"\r\n        ><el-button @click=\"download\">保存</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"2\">\r\n        格式：\r\n        <el-select\r\n          class=\"selectModule\"\r\n          v-model=\"imageType\"\r\n          placeholder=\"请选择\"\r\n        >\r\n          <el-option\r\n            v-for=\"item in options\"\r\n            :key=\"item.vlaue\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value\"\r\n          >\r\n          </el-option>\r\n        </el-select>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"3\"\r\n        ><el-button @click=\"clear\">清除</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"4\"\r\n        ><el-button\r\n          :type=\"btnHighlight || imgFlag ? 'primary' : ''\"\r\n          @click=\"repaint\"\r\n          >重绘</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"5\"\r\n        ><el-button\r\n          :type=\"btnHighlight || imgFlag ? 'primary' : ''\"\r\n          @click=\"clearTrace\"\r\n          >清除重绘</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"6\"\r\n        ><el-button\r\n          :type=\"btnHighlight || imgFlag ? 'primary' : ''\"\r\n          @click=\"saveTraceAsJSON\"\r\n          >导出重绘</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"7\"\r\n        ><el-button @click=\"fileInput\">导入重绘</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"8\" @click=\"imageInput\"\r\n        ><el-button>导入图片</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"9\"\r\n        ><el-button @click=\"traceBackWard\">撤回</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"10\"\r\n        ><el-button :type=\"eraserFlag ? 'primary' : ''\" @click=\"eraserTrigger\"\r\n          >橡皮擦</el-button\r\n        ></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"11\"\r\n        ><el-button @click=\"penShape\">笔锋</el-button></el-menu-item\r\n      >\r\n      <el-menu-item class=\"menu-item\" index=\"12\">\r\n        <el-button @click=\"scaleUp\">放大</el-button>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"13\">\r\n        <el-button @click=\"scaleDown\">缩小</el-button>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"14\">\r\n        <span>粗细：</span>\r\n        <el-input\r\n          class=\"width-input\"\r\n          placeholder=\"输入粗细\"\r\n          v-model=\"width\"\r\n          clearable\r\n          @blur=\"penSizeChange(width)\"\r\n        >\r\n        </el-input>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"15\">\r\n        <span>颜色：</span>\r\n        <el-color-picker\r\n          @change=\"colorChange(color)\"\r\n          v-model=\"color\"\r\n        ></el-color-picker>\r\n      </el-menu-item>\r\n      <el-menu-item class=\"menu-item\" index=\"16\">\r\n        <span>放大倍数{{magnifi}}</span>\r\n      </el-menu-item>\r\n    </el-menu>\r\n    <signatureCore\r\n      @updateBtnHight=\"updateBtnHight\"\r\n      @updateImgFlag=\"updateImgFlag\"\r\n      @updateEraserFlag=\"updateEraserFlag\"\r\n      @uploadImageToFather=\"uploadImageToFather\"\r\n      @uploadTraceToFather=\"uploadTraceJSONToFather\"\r\n      @updateMagnifi=\"updateMagnifi\"\r\n      :imageType=\"imageType\"\r\n      :lineWidth=\"Number(width)\"\r\n      :lineColor=\"color\"\r\n      ref=\"sigCore\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport signatureCore from './Signature/SignatureCore.vue'\r\nexport default {\r\n  data () {\r\n    return {\r\n      options: [\r\n        {\r\n          value: 'jpg',\r\n          label: 'jpg'\r\n        },\r\n        {\r\n          value: 'png',\r\n          label: 'png'\r\n        }\r\n      ],\r\n      imageType: 'jpg', // 传入子组件的图片类型\r\n      btnHighlight: false, // 按钮高亮标志量\r\n      eraserFlag: false, // 橡皮擦标志位\r\n      imgFlag: false, // 图片缓存标志量\r\n      width: 3, // 笔粗细\r\n      color: '#000', // 笔颜色\r\n      magnifi: 1 // 放大倍数\r\n    }\r\n  },\r\n  methods: {\r\n    /* 放大功能入口 */\r\n    scaleDown () {\r\n      this.$refs.sigCore.scaleDown()\r\n    },\r\n    /* 放大功能入口 */\r\n    scaleUp () {\r\n      this.$refs.sigCore.scaleUp()\r\n    },\r\n    /* 下载功能入口 */\r\n    download () {\r\n      this.$refs.sigCore.download()\r\n    },\r\n    /* 清除功能入口 */\r\n    clear () {\r\n      this.$refs.sigCore.clear()\r\n    },\r\n    /* 重绘功能入口 */\r\n    repaint () {\r\n      this.$refs.sigCore.rePaint()\r\n    },\r\n    /* 重绘导入功能入口 */\r\n    fileInput () {\r\n      this.$refs.sigCore.fileInput()\r\n    },\r\n    /* 清除重绘功能入口 */\r\n    clearTrace () {\r\n      this.$refs.sigCore.clearTrace()\r\n    },\r\n    /* 导出重绘功能入口 */\r\n    saveTraceAsJSON () {\r\n      this.$refs.sigCore.saveTraceAsJSON()\r\n    },\r\n    /* 导入图片功能入口 */\r\n    imageInput () {\r\n      this.$refs.sigCore.imageInput()\r\n    },\r\n    /* 撤回功能入口 */\r\n    traceBackWard () {\r\n      this.$refs.sigCore.traceBackWard()\r\n    },\r\n    /* 橡皮擦功能入口 */\r\n    eraserTrigger () {\r\n      this.$refs.sigCore.eraserTrigger()\r\n    },\r\n    /* 笔锋功能入口 */\r\n    penShape () {\r\n      this.$refs.sigCore.penShape()\r\n    },\r\n    /* 笔粗细改变功能入口 */\r\n    penSizeChange (width) {\r\n      this.$refs.sigCore.penSizeChange(width)\r\n    },\r\n    /* 笔颜色改变功能入口 */\r\n    colorChange (color) {\r\n      this.$refs.sigCore.colorChange(color)\r\n    },\r\n    /* 更新放大倍数 */\r\n    updateMagnifi (newValue) {\r\n      this.magnifi = newValue\r\n    },\r\n    /* 更新按钮标志量 */\r\n    updateBtnHight (newValue) {\r\n      this.btnHighlight = newValue\r\n    },\r\n    /* 更新图片标志量 */\r\n    updateImgFlag (newValue) {\r\n      this.imgFlag = newValue\r\n    },\r\n    /* 更新橡皮擦标志量 */\r\n    updateEraserFlag (newValue) {\r\n      console.log(newValue)\r\n      this.eraserFlag = newValue\r\n    },\r\n    // 内部图片传出\r\n    uploadImageToFather (img) {\r\n      // console.log(img)\r\n      this.img = img\r\n    },\r\n    // 内部json传出\r\n    uploadTraceJSONToFather (traceJSON) {\r\n      this.traceJSON = traceJSON\r\n      console.log(this.traceJSON)\r\n    },\r\n    injectJSON () {\r\n      // 向手写板传入JSON\r\n      // 获取json文件的请求\r\n      var json = 'hello just test'\r\n      this.$refs.sigCore.injectJSON(json)\r\n    },\r\n    injectImage () {\r\n      // 向手写板传入image\r\n      // 获取图片文件的请求\r\n      var image = 'hello I am image' // 格式 data:image/jpeg;base64\r\n      this.$refs.sigCore.injectImage(image)\r\n    }\r\n  },\r\n  components: { signatureCore }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.selectModule {\r\n  width: 100px;\r\n}\r\n.menu-item {\r\n  padding: 0 5px;\r\n}\r\n.width-input {\r\n  max-width: 80px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./elementUI.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./elementUI.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./elementUI.vue?vue&type=template&id=41f433c7&scoped=true&\"\nimport script from \"./elementUI.vue?vue&type=script&lang=js&\"\nexport * from \"./elementUI.vue?vue&type=script&lang=js&\"\nimport style0 from \"./elementUI.vue?vue&type=style&index=0&id=41f433c7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"41f433c7\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignatureCore.vue?vue&type=style&index=1&lang=css&\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAEQSURBVEhL1ZIxagJBGEY3GAI5gKYOaOEFLLyIYCGktAmCXbDzAFaxDKSxsEkOkwOkMSnTColJ3r/4wbDM6O7sWPjgscywzGP4JzsHOvvvyRjjN47y1QmwwC9+4A8mDymwwmt8waQhN3BpG3CFr5gk5AuIJCEF7KBiQNQKKbDFT+xiiKiQAmts4zsmDSmwwzds4S2WDR19de6Q+/iFFrrBsqEp/uFTvirgBjTkHlYJ3aOd8YwN23DxBUTZUHRAHAvVDohQyPaSBIQbslc3RxuyN2A8ov0wy1flUWiDwRuIC1yihR5sowILPHgDl5jQwSGHqBKKCgg3ZDNqepxgdEC4oZC1AsJCA7zzOMTagcRk2T9Q93nXufGozQAAAABJRU5ErkJggg==\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./elementUI.vue?vue&type=style&index=0&id=41f433c7&scoped=true&lang=css&\""],"sourceRoot":""}